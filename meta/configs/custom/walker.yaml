- link:
    ~/.config/walker:
      path: walker/*
      glob: true
      exclude: [walker/elephant]
    ~/.config/elephant:
      path: walker/elephant/*
      glob: true

- shell:
  - sudo pacman -S --noconfirm --needed omarchy-walker
  - elephant service enable
  - |
    cat << 'EOF' > ~/.config/systemd/user/walker.service
    [Unit]
    Description=Walker
    Wants=elephant.service
    After=graphical-session.target elephant.service

    [Service]
    ExecStart=/usr/bin/walker --gapplication-service
    Restart=on-failure

    [Install]
    WantedBy=graphical-session.target
    EOF
  - systemctl --user daemon-reload
  - systemctl --user enable walker
  - systemctl --user restart elephant walker 2>/dev/null || true
